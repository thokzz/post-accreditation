<!-- app/templates/auth/setup_2fa.html -->
{% extends "base.html" %}

{% block title %}Setup 2FA - Post Accreditation System{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-6">
        <div class="card">
            <div class="card-header text-center">
                <h4 class="mb-0">
                    <i class="bi bi-shield-plus me-2"></i>
                    Setup Two-Factor Authentication
                </h4>
            </div>
            <div class="card-body">
                <div class="text-center mb-4">
                    <h6>Step 1: Scan QR Code</h6>
                    <p class="text-muted">Use your authenticator app to scan this QR code</p>
                    <img src="data:image/png;base64,{{ qr_code }}" class="img-fluid border rounded">
                    <p class="small text-muted mt-2">
                        Manual entry key: <code>{{ secret }}</code>
                    </p>
                </div>
                
                <div class="text-center">
                    <h6>Step 2: Enter Verification Code</h6>
                    <form method="POST">
                        {{ form.hidden_tag() }}
                        
                        <div class="mb-3">
                            {{ form.token(class="form-control text-center", 
                                         style="font-size: 1.5rem; letter-spacing: 0.5rem;",
                                         placeholder="000000") }}
                        </div>
                        
                        <button type="submit" class="btn btn-success">
                            <i class="bi bi-check-circle me-2"></i>
                            Enable 2FA
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
